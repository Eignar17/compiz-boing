/*
 * This file is autogenerated with bcop:
 * The Compiz option code generator
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include <compiz-core.h>

#include "boing_options.h"

static int BoingOptionsDisplayPrivateIndex;

static CompMetadata boingOptionsMetadata;

static CompPluginVTable *boingPluginVTable = NULL;
CompPluginVTable boingOptionsVTable;

#define BOING_OPTIONS_DISPLAY(d) PLUGIN_DISPLAY(d, BoingOptions, o)
#define BOING_OPTIONS_SCREEN(s) PLUGIN_SCREEN(s, BoingOptions, o)

typedef struct _BoingOptionsDisplay
{
    int screenPrivateIndex;

    CompOption opt[BoingDisplayOptionNum];
    boingDisplayOptionChangeNotifyProc notify[BoingDisplayOptionNum];
} BoingOptionsDisplay;

typedef struct _BoingOptionsScreen
{
} BoingOptionsScreen;

int boingGetNumLeaves (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return od->opt[BoingDisplayOptionNumLeaves].value.i;
}

CompOption * boingGetNumLeavesOption (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionNumLeaves];
}

void boingSetNumLeavesNotify (CompDisplay *d, boingDisplayOptionChangeNotifyProc notify)
{
    BOING_OPTIONS_DISPLAY(d);
    od->notify[BoingDisplayOptionNumLeaves] = notify;
}

float boingGetLeafSize (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return od->opt[BoingDisplayOptionLeafSize].value.f;
}

CompOption * boingGetLeafSizeOption (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionLeafSize];
}

void boingSetLeafSizeNotify (CompDisplay *d, boingDisplayOptionChangeNotifyProc notify)
{
    BOING_OPTIONS_DISPLAY(d);
    od->notify[BoingDisplayOptionLeafSize] = notify;
}

int boingGetWindSpeed (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return od->opt[BoingDisplayOptionWindSpeed].value.i;
}

CompOption * boingGetWindSpeedOption (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionWindSpeed];
}

void boingSetWindSpeedNotify (CompDisplay *d, boingDisplayOptionChangeNotifyProc notify)
{
    BOING_OPTIONS_DISPLAY(d);
    od->notify[BoingDisplayOptionWindSpeed] = notify;
}

int boingGetAutumnUpdateDelay (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return od->opt[BoingDisplayOptionAutumnUpdateDelay].value.i;
}

CompOption * boingGetAutumnUpdateDelayOption (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionAutumnUpdateDelay];
}

void boingSetAutumnUpdateDelayNotify (CompDisplay *d, boingDisplayOptionChangeNotifyProc notify)
{
    BOING_OPTIONS_DISPLAY(d);
    od->notify[BoingDisplayOptionAutumnUpdateDelay] = notify;
}

int boingGetScreenBoxing (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return od->opt[BoingDisplayOptionScreenBoxing].value.i;
}

CompOption * boingGetScreenBoxingOption (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionScreenBoxing];
}

void boingSetScreenBoxingNotify (CompDisplay *d, boingDisplayOptionChangeNotifyProc notify)
{
    BOING_OPTIONS_DISPLAY(d);
    od->notify[BoingDisplayOptionScreenBoxing] = notify;
}

int boingGetScreenDepth (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return od->opt[BoingDisplayOptionScreenDepth].value.i;
}

CompOption * boingGetScreenDepthOption (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionScreenDepth];
}

void boingSetScreenDepthNotify (CompDisplay *d, boingDisplayOptionChangeNotifyProc notify)
{
    BOING_OPTIONS_DISPLAY(d);
    od->notify[BoingDisplayOptionScreenDepth] = notify;
}

Bool boingGetLeavesOverWindows (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return od->opt[BoingDisplayOptionLeavesOverWindows].value.b;
}

CompOption * boingGetLeavesOverWindowsOption (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionLeavesOverWindows];
}

void boingSetLeavesOverWindowsNotify (CompDisplay *d, boingDisplayOptionChangeNotifyProc notify)
{
    BOING_OPTIONS_DISPLAY(d);
    od->notify[BoingDisplayOptionLeavesOverWindows] = notify;
}

Bool boingGetLeafRotation (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return od->opt[BoingDisplayOptionLeafRotation].value.b;
}

CompOption * boingGetLeafRotationOption (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionLeafRotation];
}

void boingSetLeafRotationNotify (CompDisplay *d, boingDisplayOptionChangeNotifyProc notify)
{
    BOING_OPTIONS_DISPLAY(d);
    od->notify[BoingDisplayOptionLeafRotation] = notify;
}

int boingGetWindDirection (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return od->opt[BoingDisplayOptionWindDirection].value.i;
}

CompOption * boingGetWindDirectionOption (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionWindDirection];
}

void boingSetWindDirectionNotify (CompDisplay *d, boingDisplayOptionChangeNotifyProc notify)
{
    BOING_OPTIONS_DISPLAY(d);
    od->notify[BoingDisplayOptionWindDirection] = notify;
}

CompListValue * boingGetLeafTextures (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionLeafTextures].value.list;
}

CompOption * boingGetLeafTexturesOption (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionLeafTextures];
}

void boingSetLeafTexturesNotify (CompDisplay *d, boingDisplayOptionChangeNotifyProc notify)
{
    BOING_OPTIONS_DISPLAY(d);
    od->notify[BoingDisplayOptionLeafTextures] = notify;
}

Bool boingGetUseBlending (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return od->opt[BoingDisplayOptionUseBlending].value.b;
}

CompOption * boingGetUseBlendingOption (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionUseBlending];
}

void boingSetUseBlendingNotify (CompDisplay *d, boingDisplayOptionChangeNotifyProc notify)
{
    BOING_OPTIONS_DISPLAY(d);
    od->notify[BoingDisplayOptionUseBlending] = notify;
}

Bool boingGetUseTextures (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return od->opt[BoingDisplayOptionUseTextures].value.b;
}

CompOption * boingGetUseTexturesOption (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionUseTextures];
}

void boingSetUseTexturesNotify (CompDisplay *d, boingDisplayOptionChangeNotifyProc notify)
{
    BOING_OPTIONS_DISPLAY(d);
    od->notify[BoingDisplayOptionUseTextures] = notify;
}

CompAction * boingGetToggleKey (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionToggleKey].value.action;
}

void boingSetToggleKeyInitiate (CompDisplay *d, CompActionCallBackProc init)
{
    BOING_OPTIONS_DISPLAY(d);
    od->opt[BoingDisplayOptionToggleKey].value.action.initiate = init;
}

void boingSetToggleKeyTerminate (CompDisplay *d, CompActionCallBackProc term)
{
    BOING_OPTIONS_DISPLAY(d);
    od->opt[BoingDisplayOptionToggleKey].value.action.terminate = term;
}

CompOption * boingGetToggleKeyOption (CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[BoingDisplayOptionToggleKey];
}

void boingSetToggleKeyNotify (CompDisplay *d, boingDisplayOptionChangeNotifyProc notify)
{
    BOING_OPTIONS_DISPLAY(d);
    od->notify[BoingDisplayOptionToggleKey] = notify;
}

CompOption * boingGetDisplayOption (CompDisplay *d, BoingDisplayOptions num)
{
    BOING_OPTIONS_DISPLAY(d);
    return &od->opt[num];
}

static const CompMetadataOptionInfo boingOptionsDisplayOptionInfo[] = {
    { "num_leaves", "int", "<min>0</min><max>10000</max>", 0, 0 },
    { "leaf_size", "float", "<min>0.0</min><max>100.0</max>", 0, 0 },
    { "wind_speed", "int", "<min>0</min><max>100</max>", 0, 0 },
    { "autumn_update_delay", "int", "<min>10</min><max>200</max>", 0, 0 },
    { "screen_boxing", "int", "<min>-2000</min><max>2000</max>", 0, 0 },
    { "screen_depth", "int", "<min>0</min><max>2000</max>", 0, 0 },
    { "leaves_over_windows", "bool", 0, 0, 0 },
    { "leaf_rotation", "bool", 0, 0, 0 },
    { "wind_direction", "int", "<min>0</min><max>3</max>", 0, 0 },
    { "leaf_textures", "list", "<type>string</type>", 0, 0 },
    { "use_blending", "bool", 0, 0, 0 },
    { "use_textures", "bool", 0, 0, 0 },
    { "toggle_key", "key", 0, 0, 0 },
};

static Bool boingOptionsSetDisplayOption (CompPlugin *plugin, CompDisplay *d, const char *name, CompOptionValue *value)
{
    BOING_OPTIONS_DISPLAY(d);
    CompOption *o;
    int        index;

    o = compFindOption (od->opt, BoingDisplayOptionNum, name, &index);

    if (!o)
        return FALSE;

    switch (index)
    {
     case BoingDisplayOptionNumLeaves:
        if (compSetDisplayOption (d, o, value))
        {
            if (od->notify[BoingDisplayOptionNumLeaves])
                (*od->notify[BoingDisplayOptionNumLeaves]) (d, o, BoingDisplayOptionNumLeaves);
            return TRUE;
        }
        break;
     case BoingDisplayOptionLeafSize:
        if (compSetDisplayOption (d, o, value))
        {
            if (od->notify[BoingDisplayOptionLeafSize])
                (*od->notify[BoingDisplayOptionLeafSize]) (d, o, BoingDisplayOptionLeafSize);
            return TRUE;
        }
        break;
     case BoingDisplayOptionWindSpeed:
        if (compSetDisplayOption (d, o, value))
        {
            if (od->notify[BoingDisplayOptionWindSpeed])
                (*od->notify[BoingDisplayOptionWindSpeed]) (d, o, BoingDisplayOptionWindSpeed);
            return TRUE;
        }
        break;
     case BoingDisplayOptionAutumnUpdateDelay:
        if (compSetDisplayOption (d, o, value))
        {
            if (od->notify[BoingDisplayOptionAutumnUpdateDelay])
                (*od->notify[BoingDisplayOptionAutumnUpdateDelay]) (d, o, BoingDisplayOptionAutumnUpdateDelay);
            return TRUE;
        }
        break;
     case BoingDisplayOptionScreenBoxing:
        if (compSetDisplayOption (d, o, value))
        {
            if (od->notify[BoingDisplayOptionScreenBoxing])
                (*od->notify[BoingDisplayOptionScreenBoxing]) (d, o, BoingDisplayOptionScreenBoxing);
            return TRUE;
        }
        break;
     case BoingDisplayOptionScreenDepth:
        if (compSetDisplayOption (d, o, value))
        {
            if (od->notify[BoingDisplayOptionScreenDepth])
                (*od->notify[BoingDisplayOptionScreenDepth]) (d, o, BoingDisplayOptionScreenDepth);
            return TRUE;
        }
        break;
     case BoingDisplayOptionLeavesOverWindows:
        if (compSetDisplayOption (d, o, value))
        {
            if (od->notify[BoingDisplayOptionLeavesOverWindows])
                (*od->notify[BoingDisplayOptionLeavesOverWindows]) (d, o, BoingDisplayOptionLeavesOverWindows);
            return TRUE;
        }
        break;
     case BoingDisplayOptionLeafRotation:
        if (compSetDisplayOption (d, o, value))
        {
            if (od->notify[BoingDisplayOptionLeafRotation])
                (*od->notify[BoingDisplayOptionLeafRotation]) (d, o, BoingDisplayOptionLeafRotation);
            return TRUE;
        }
        break;
     case BoingDisplayOptionWindDirection:
        if (compSetDisplayOption (d, o, value))
        {
            if (od->notify[BoingDisplayOptionWindDirection])
                (*od->notify[BoingDisplayOptionWindDirection]) (d, o, BoingDisplayOptionWindDirection);
            return TRUE;
        }
        break;
     case BoingDisplayOptionLeafTextures:
        if (compSetDisplayOption (d, o, value))
        {
            if (od->notify[BoingDisplayOptionLeafTextures])
                (*od->notify[BoingDisplayOptionLeafTextures]) (d, o, BoingDisplayOptionLeafTextures);
            return TRUE;
        }
        break;
     case BoingDisplayOptionUseBlending:
        if (compSetDisplayOption (d, o, value))
        {
            if (od->notify[BoingDisplayOptionUseBlending])
                (*od->notify[BoingDisplayOptionUseBlending]) (d, o, BoingDisplayOptionUseBlending);
            return TRUE;
        }
        break;
     case BoingDisplayOptionUseTextures:
        if (compSetDisplayOption (d, o, value))
        {
            if (od->notify[BoingDisplayOptionUseTextures])
                (*od->notify[BoingDisplayOptionUseTextures]) (d, o, BoingDisplayOptionUseTextures);
            return TRUE;
        }
        break;
     case BoingDisplayOptionToggleKey:
        if (compSetDisplayOption (d, o, value))
        {
            if (od->notify[BoingDisplayOptionToggleKey])
                (*od->notify[BoingDisplayOptionToggleKey]) (d, o, BoingDisplayOptionToggleKey);
            return TRUE;
        }
        break;
    default:
        break;
    }
    return FALSE;
}

static CompOption * boingOptionsGetDisplayOptions (CompPlugin *plugin, CompDisplay *d, int *count)
{
    BOING_OPTIONS_DISPLAY(d);
    if (!od)
    {
        *count = 0;
        return NULL;
    }
    *count = BoingDisplayOptionNum;
    return od->opt;
}

static Bool boingOptionsInitScreen (CompPlugin *p, CompScreen *s)
{
    BoingOptionsScreen *os;
    
    BOING_OPTIONS_DISPLAY (s->display);

    os = calloc (1, sizeof(BoingOptionsScreen));
    if (!os)
        return FALSE;

    s->base.privates[od->screenPrivateIndex].ptr = os;

    
    return TRUE;
}

static void boingOptionsFiniScreen (CompPlugin *p, CompScreen *s)
{
    BOING_OPTIONS_SCREEN (s);
    BOING_OPTIONS_DISPLAY (s->display);

    free (os);
    s->base.privates[od->screenPrivateIndex].ptr = NULL;
}

static Bool boingOptionsInitDisplay (CompPlugin *p, CompDisplay *d)
{
    BoingOptionsDisplay *od;
   
    
    od = calloc (1, sizeof(BoingOptionsDisplay));
    if (!od)
        return FALSE;

    od->screenPrivateIndex = allocateScreenPrivateIndex(d);
    if (od->screenPrivateIndex < 0)
    {
        free(od);
        return FALSE;
    }

    d->base.privates[BoingOptionsDisplayPrivateIndex].ptr = od;

    if (!compInitDisplayOptionsFromMetadata (d, &boingOptionsMetadata, boingOptionsDisplayOptionInfo, od->opt, BoingDisplayOptionNum))
    {
        free (od);
        return FALSE;
    }

    return TRUE;
}

static void boingOptionsFiniDisplay (CompPlugin *p, CompDisplay *d)
{
    BOING_OPTIONS_DISPLAY (d);

    freeScreenPrivateIndex(d, od->screenPrivateIndex);

    compFiniDisplayOptions (d, od->opt, BoingDisplayOptionNum);

    free (od);
    d->base.privates[BoingOptionsDisplayPrivateIndex].ptr = NULL;
}

static Bool boingOptionsInit (CompPlugin *p)
{
    BoingOptionsDisplayPrivateIndex = allocateDisplayPrivateIndex();
    if (BoingOptionsDisplayPrivateIndex < 0)
        return FALSE;

    if (!compInitPluginMetadataFromInfo (&boingOptionsMetadata, "boing",boingOptionsDisplayOptionInfo, BoingDisplayOptionNum, 0, 0))
        return FALSE;

    compAddMetadataFromFile (&boingOptionsMetadata, "boing");
    if (boingPluginVTable && boingPluginVTable->init)
        return boingPluginVTable->init (p);
    return TRUE;
}

static void boingOptionsFini (CompPlugin *p)
{
    if (boingPluginVTable && boingPluginVTable->fini)
        boingPluginVTable->fini (p);

    if (BoingOptionsDisplayPrivateIndex >= 0)
        freeDisplayPrivateIndex (BoingOptionsDisplayPrivateIndex);

    compFiniMetadata (&boingOptionsMetadata);
}

static CompBool boingOptionsInitObject (CompPlugin *p, CompObject *o)
{
    static InitPluginObjectProc dispTab[] = {
        (InitPluginObjectProc) 0,
        (InitPluginObjectProc) boingOptionsInitDisplay,
        (InitPluginObjectProc) boingOptionsInitScreen
    };

    RETURN_DISPATCH (o, dispTab, ARRAY_SIZE (dispTab), TRUE, (p, o));
}

static void boingOptionsFiniObject (CompPlugin *p, CompObject *o)
{
    static FiniPluginObjectProc dispTab[] = {
        (FiniPluginObjectProc) 0,
        (FiniPluginObjectProc) boingOptionsFiniDisplay,
        (FiniPluginObjectProc) boingOptionsFiniScreen
    };

    DISPATCH (o, dispTab, ARRAY_SIZE (dispTab), (p, o));
}

static CompBool boingOptionsInitObjectWrapper (CompPlugin *p, CompObject *o)
{
    CompBool rv = TRUE;
    rv = boingOptionsInitObject (p, o);
    if (boingPluginVTable->initObject)
        rv &= boingPluginVTable->initObject (p, o);
    return rv;
}

static void boingOptionsFiniObjectWrapper (CompPlugin *p, CompObject *o)
{
    if (boingPluginVTable->finiObject)
        boingPluginVTable->finiObject (p, o);
    boingOptionsFiniObject (p, o);
}

static CompOption * boingOptionsGetObjectOptions (CompPlugin *p, CompObject *o, int *count)
{
    static GetPluginObjectOptionsProc dispTab[] = {
        (GetPluginObjectOptionsProc) 0,
            (GetPluginObjectOptionsProc) boingOptionsGetDisplayOptions,
    };

    *count = 0;
    RETURN_DISPATCH (o, dispTab, ARRAY_SIZE (dispTab),
		     NULL, (p, o, count));
}

static CompBool boingOptionsSetObjectOption (CompPlugin *p, CompObject *o, const char *name, CompOptionValue *value)
{
    static SetPluginObjectOptionProc dispTab[] = {
        (SetPluginObjectOptionProc) 0,
        (SetPluginObjectOptionProc) boingOptionsSetDisplayOption,
    };

    RETURN_DISPATCH (o, dispTab, ARRAY_SIZE (dispTab), FALSE,
		     (p, o, name, value));
}

static CompMetadata *
boingOptionsGetMetadata (CompPlugin *plugin)
{
    return &boingOptionsMetadata;
}

CompPluginVTable *getCompPluginInfo20070830 (void)
{
    if (!boingPluginVTable)
    {
        boingPluginVTable = getCompPluginInfo ();
        memcpy(&boingOptionsVTable, boingPluginVTable, sizeof(CompPluginVTable));
        boingOptionsVTable.getMetadata = boingOptionsGetMetadata;
        boingOptionsVTable.init = boingOptionsInit;
        boingOptionsVTable.fini = boingOptionsFini;
        boingOptionsVTable.initObject = boingOptionsInitObjectWrapper;
        boingOptionsVTable.finiObject = boingOptionsFiniObjectWrapper;
        boingOptionsVTable.getObjectOptions = boingOptionsGetObjectOptions;
	boingOptionsVTable.setObjectOption = boingOptionsSetObjectOption;
	
    }
    return &boingOptionsVTable;
}

